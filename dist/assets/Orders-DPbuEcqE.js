import{j as e}from"./chunk-lottie-CUWK48HK.js";import{r as f}from"./chunk-charts-BaLkbnPn.js";import{B as I}from"./button-D2k3dhdS.js";import{I as F}from"./input-2E-e808x.js";import{C as N,d as g,a as M,b as O}from"./card-BnWLQtdX.js";import{B as A}from"./badge-DEC39sga.js";import{S as v,a as y,b as S,c as w,d as p}from"./select--VCE_9vh.js";import{u as B,a as D}from"./useOrders-DrXpvxJu.js";import{c as E,q as _,u as q}from"./index-CEsqnVuV.js";import{S as H}from"./search-POKoYbeB.js";import{S as V}from"./shopping-cart-BaoiEdfa.js";import{P as z}from"./package-eywWNtCk.js";import{P as Q}from"./phone-BFIR4Vjf.js";import{M as T}from"./map-pin-BUyYgzJV.js";import{C as R}from"./credit-card-B1i6fS4M.js";import{E as U}from"./eye-D2gYSMfC.js";import"./index-D4-djExh.js";import"./Combination-sOn4m88U.js";import"./index-ZeZSZmiz.js";import"./chevron-down-ggRHhYVY.js";import"./chevron-up-CehlN3si.js";import"./check-BVHCcr3z.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Y=E("funnel",W),C={created:"Замовлення оформлено",accepted:"Прийнято",paid:"Оплачено",packed:"Спаковано",shipped:"Відправлено",arrived:"Прибуло",completed:"Залишити відгук",processing:"В обробці",assembled:"Зібрано",in_transit:"В дорозі"},b=["accepted","paid","packed","shipped","arrived","completed"],G={nova_poshta:"Нова Пошта",ukrposhta:"Укрпошта",pickup:"Самовивіз"},J=l=>{const i=typeof l=="string"?new Date(l):l,m=String(i.getHours()).padStart(2,"0"),d=String(i.getMinutes()).padStart(2,"0"),o=String(i.getDate()).padStart(2,"0"),c=String(i.getMonth()+1).padStart(2,"0"),x=i.getFullYear();return`${m}:${d}, ${o}.${c}.${x}`};function ge(){const l=_(),{data:i=[],isLoading:m}=B(),{data:d=[]}=q(),o=D(),[c,x]=f.useState(""),[h,k]=f.useState("all"),u=i.filter(s=>{const a=String(s.id).toLowerCase().includes(c.toLowerCase())||s.customer.name.toLowerCase().includes(c.toLowerCase())||s.customer.phone.includes(c),n=h==="all"||s.status===h;return a&&n}),P=(s,a)=>{o.mutate({id:s,status:a},{onSuccess:()=>{}})},$=s=>{var a;return((a=d.find(n=>n.code===s))==null?void 0:a.name)||s};return m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-muted-foreground",children:"Завантаження замовлень..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(N,{children:e.jsx(g,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(H,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(F,{placeholder:"Пошук за ID, ім'ям або телефоном...",value:c,onChange:s=>x(s.target.value),className:"pl-9"})]}),e.jsxs(v,{value:h,onValueChange:k,children:[e.jsxs(y,{className:"w-full sm:w-48",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),e.jsx(S,{placeholder:"Статус"})]}),e.jsxs(w,{children:[e.jsx(p,{value:"all",children:"Всі статуси"}),b.map(s=>e.jsx(p,{value:s,children:C[s]},s))]})]})]})})}),e.jsxs(N,{children:[e.jsx(M,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),"Список замовлень"]})})}),e.jsx(g,{children:e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Заказ"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Сумма"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Покупатель"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Доставка и оплата"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Статус"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Действия"})]})}),e.jsx("tbody",{children:u.map(s=>{var j;const a=s.items[0],n=s.items.reduce((t,L)=>t+L.quantity,0),r=d.find(t=>t.code===(a==null?void 0:a.productId));return e.jsxs("tr",{className:"border-b hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>l(`/admin/orders/${s.id}`),children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:r!=null&&r.images&&r.images.length>0?e.jsx("img",{src:r.images[0],alt:r.name,className:"w-12 h-12 object-cover rounded"}):e.jsx("div",{className:"w-12 h-12 bg-muted rounded flex items-center justify-center",children:e.jsx(z,{className:"h-6 w-6 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-mono font-bold text-sm",children:s.id}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:J(s.createdAt)}),e.jsx("div",{className:"text-sm font-medium mt-1 truncate",children:a?$(a.productId):"Товар"}),s.items.length>1&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["+",s.items.length-1," товарів в замовленні"]})]})]})}),e.jsxs("td",{className:"py-4 px-4",children:[e.jsxs("div",{className:"font-bold",children:["₴",s.total]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[n," ","шт."]})]}),e.jsxs("td",{className:"py-4 px-4",children:[e.jsx("div",{className:"font-medium",children:s.customer.name}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-1 mt-1",children:[e.jsx(Q,{className:"h-3 w-3"}),s.customer.phone]})]}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"space-y-2 text-sm text-foreground",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(T,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{children:G[s.delivery.method]}),s.delivery.city&&e.jsxs("div",{className:"text-xs mt-0.5",children:[s.delivery.city,s.delivery.warehouse&&`, ${s.delivery.warehouse}`,s.delivery.postIndex&&`, ${s.delivery.postIndex}`,s.delivery.address&&`, ${s.delivery.address}`]})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(R,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[s.payment.method==="wayforpay"&&"Онлайн оплата (WayForPay)",s.payment.method==="nalojka"&&"Оплата при отриманні",s.payment.method==="fopiban"&&"Оплата на рахунок ФОП"]})]})]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{value:s.status,onValueChange:t=>{P(s.id,t)},onClick:t=>t.stopPropagation(),children:[e.jsx(y,{className:"w-40",children:e.jsx(S,{})}),e.jsx(w,{children:b.map(t=>e.jsx(p,{value:t,children:C[t]},t))})]}),((j=s.payment)==null?void 0:j.status)==="paid"&&e.jsx(A,{className:"bg-green-100 text-green-800 text-xs",children:"Оплачено"})]})}),e.jsx("td",{className:"py-4 px-4 text-right",children:e.jsx(I,{variant:"outline",size:"icon",onClick:t=>{t.stopPropagation(),l(`/admin/orders/${s.id}`)},children:e.jsx(U,{className:"h-4 w-4"})})})]},s.id)})})]}),u.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Замовлення не знайдено"})]})})]})]})}export{ge as Orders};
