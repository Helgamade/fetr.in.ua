import{j as e}from"./chunk-lottie-CUWK48HK.js";import{r as x}from"./chunk-charts-BaLkbnPn.js";import{B as o}from"./button-CthZnacx.js";import{I as h}from"./input-BXec95Z_.js";import{C as j,d as f}from"./card-BSGDknr9.js";import{D as q,a as E,b as Q,c as T,d as k}from"./dialog-BJyV5hg7.js";import{L as m}from"./label-DKkqBypw.js";import{T as N}from"./textarea-COqQe70d.js";import{d as I,e as v,f as g,a3 as u,z as _}from"./index-D2NyTv7N.js";import{S as K}from"./search-CUrwVdP1.js";import{P,T as R}from"./trash-2-DqmK1xeF.js";import{S as U}from"./square-pen-B_srtqrU.js";import"./index-CMDvW82E.js";import"./Combination-DslA7HWg.js";function z(){return I({queryKey:["options"],queryFn:()=>u.getAll()})}function G(){const a=v();return g({mutationFn:n=>u.create(n),onSuccess:()=>{a.invalidateQueries({queryKey:["options"]})}})}function V(){const a=v();return g({mutationFn:({id:n,data:p})=>u.update(n,p),onSuccess:()=>{a.invalidateQueries({queryKey:["options"]})}})}function W(){const a=v();return g({mutationFn:n=>u.delete(n),onSuccess:()=>{a.invalidateQueries({queryKey:["options"]})}})}function ae(){const{data:a=[],isLoading:n}=z(),p=G(),C=V(),S=W(),[d,w]=x.useState(""),[t,i]=x.useState(null),[O,l]=x.useState(!1),{toast:c}=_(),y=a.filter(s=>{var r;return s.name.toLowerCase().includes(d.toLowerCase())||((r=s.description)==null?void 0:r.toLowerCase().includes(d.toLowerCase()))}),b=()=>{i({id:0,code:"",name:"",price:0,description:"",icon:""}),l(!0)},L=s=>{i({...s}),l(!0)},D=()=>{if(!t)return;if(!t.name||t.price===void 0){c({title:"Помилка",description:"Заповніть всі обов'язкові поля",variant:"destructive"});return}const s={name:t.name,price:t.price,description:t.description,icon:t.icon||null};t.id===0?p.mutate(s,{onSuccess:()=>{c({title:"Створено",description:"Опцію успішно створено"}),l(!1),i(null)},onError:r=>{c({title:"Помилка",description:r.message||"Не вдалося створити опцію",variant:"destructive"})}}):C.mutate({id:t.id,data:s},{onSuccess:()=>{c({title:"Збережено",description:"Опцію успішно оновлено"}),l(!1),i(null)},onError:r=>{c({title:"Помилка",description:r.message||"Не вдалося оновити опцію",variant:"destructive"})}})},F=s=>{confirm(`Видалити опцію "${s.name}"?`)&&S.mutate(s.id,{onSuccess:()=>{c({title:"Видалено",description:`Опцію "${s.name}" видалено`,variant:"destructive"})},onError:r=>{c({title:"Помилка",description:r.message||"Не вдалося видалити опцію",variant:"destructive"})}})};return n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-muted-foreground",children:"Завантаження опцій..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(j,{children:e.jsx(f,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(h,{placeholder:"Пошук опцій...",value:d,onChange:s=>w(s.target.value),className:"pl-9"})]}),e.jsxs(o,{onClick:b,children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Додати опцію"]})]})})}),e.jsxs("div",{className:"grid gap-4",children:[y.map(s=>e.jsx(j,{children:e.jsx(f,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),e.jsxs("span",{className:"text-lg font-bold text-primary",children:["+",s.price," ₴"]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Код: ",s.code]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>L(s),children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>F(s),children:e.jsx(R,{className:"h-4 w-4"})})]})]})})},s.id)),y.length===0&&e.jsx(j,{children:e.jsx(f,{className:"pt-6",children:e.jsx("div",{className:"text-center text-muted-foreground py-8",children:d?"Опції не знайдено":"Опції відсутні. Додайте першу опцію."})})})]}),t&&e.jsx(q,{open:O,onOpenChange:l,children:e.jsxs(E,{children:[e.jsx(Q,{children:e.jsx(T,{children:t.id===0?"Додати опцію":"Редагувати опцію"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"name",children:"Назва *"}),e.jsx(h,{id:"name",value:t.name,onChange:s=>i({...t,name:s.target.value}),placeholder:"Подарункова упаковка"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"price",children:"Ціна (₴) *"}),e.jsx(h,{id:"price",type:"number",min:"0",step:"0.01",value:t.price,onChange:s=>i({...t,price:parseFloat(s.target.value)||0}),placeholder:"75.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",children:"Опис"}),e.jsx(N,{id:"description",value:t.description||"",onChange:s=>i({...t,description:s.target.value}),placeholder:"Красива святкова упаковка з бантом",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"icon",children:"SVG іконка (код або URL)"}),e.jsx(N,{id:"icon",value:t.icon||"",onChange:s=>i({...t,icon:s.target.value}),placeholder:"Вставте SVG код або URL іконки",rows:4}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Можна вставити SVG код або URL до зображення. Іконка буде відображатися в кольорі primary."}),t.icon&&e.jsxs("div",{className:"mt-2 p-3 border rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Попередній перегляд:"}),e.jsxs("div",{className:"flex items-center gap-2 text-primary",children:[t.icon.trim().startsWith("<svg")?e.jsx("div",{className:"w-4 h-4 [&_svg]:w-full [&_svg]:h-full [&_svg]:text-primary [&_svg]:stroke-current",dangerouslySetInnerHTML:{__html:t.icon}}):t.icon.startsWith("http")||t.icon.startsWith("/")?e.jsx("img",{src:t.icon,alt:"Icon",className:"w-4 h-4 object-contain",onError:s=>{s.target.style.display="none"}}):null,e.jsx("span",{className:"text-sm",children:"Тестовий текст"})]})]})]})]}),e.jsxs(k,{children:[e.jsx(o,{variant:"outline",onClick:()=>l(!1),children:"Скасувати"}),e.jsx(o,{onClick:D,children:"Зберегти"})]})]})})]})}export{ae as Options};
