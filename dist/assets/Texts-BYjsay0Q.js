import{j as e}from"./chunk-lottie-CUWK48HK.js";import{r as l}from"./chunk-charts-BaLkbnPn.js";import{u as O,a as V,b as H,c as Q}from"./useTexts-B3kGWpp3.js";import{C as x,a as q,b as R,c as U,d as h}from"./card-hmVZsDUq.js";import{I as d}from"./input-CX5tNebo.js";import{T as k}from"./textarea-qGHGkmRy.js";import{B as r}from"./button-DbOqy-bd.js";import{L as t}from"./label-C5UElfPr.js";import{T as $,a as G,b as J,c as K}from"./tabs-Dw6NuoLE.js";import{D as M,a as W,b as X,c as Y,d as Z}from"./dialog-C08eaag5.js";import{B as _}from"./index-D_0WsTs2.js";import{P as ee,T as F}from"./trash-2-CKJaomP5.js";import{S as se}from"./search-DwN3ncs1.js";import{S as L}from"./save-B2xNZquK.js";import"./index-D4-djExh.js";import"./index-CbFhp7S4.js";import"./Combination-Cynz0wEz.js";function ge(){const{toast:n}=_(),{data:z=[],isLoading:E}=O(),v=V(),T=H(),I=Q(),[p,u]=l.useState(null),[f,g]=l.useState(""),[N,y]=l.useState(""),[P,j]=l.useState(!1),[i,o]=l.useState({key:"",value:"",namespace:"",description:""}),[m,A]=l.useState(""),c=z.filter(s=>{if(!m.trim())return!0;const a=m.toLowerCase();return s.key.toLowerCase().includes(a)||s.value.toLowerCase().includes(a)||s.namespace.toLowerCase().includes(a)||s.description&&s.description.toLowerCase().includes(a)}),C=Array.from(new Set(c.map(s=>s.namespace))).sort(),b=s=>{u(s.id),g(s.value),y(s.description||"")},D=async s=>{try{await v.mutateAsync({id:s.id,value:f,description:N}),n({title:"Збережено",description:"Текст успішно оновлено"}),u(null)}catch(a){n({title:"Помилка",description:a.message||"Не вдалося зберегти текст",variant:"destructive"})}},B=async()=>{if(!i.key||!i.value||!i.namespace){n({title:"Помилка",description:"Заповніть всі обов'язкові поля",variant:"destructive"});return}if(!i.key.includes(".")){n({title:"Помилка",description:"Ключ повинен бути у форматі: namespace.key (наприклад, nav.home)",variant:"destructive"});return}try{await T.mutateAsync({key:i.key,value:i.value,namespace:i.namespace,description:i.description}),n({title:"Створено",description:"Текст успішно створено"}),j(!1),o({key:"",value:"",namespace:"",description:""})}catch(s){n({title:"Помилка",description:s.message||"Не вдалося створити текст",variant:"destructive"})}},S=async s=>{if(confirm(`Ви впевнені, що хочете видалити текст "${s.key}"?`))try{await I.mutateAsync(s.id),n({title:"Видалено",description:"Текст успішно видалено"})}catch(a){n({title:"Помилка",description:a.message||"Не вдалося видалити текст",variant:"destructive"})}};return E?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-muted-foreground",children:"Завантаження текстів..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(x,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Управління текстами сайту"}),e.jsx(U,{children:"Всі тексти організовані по namespace для легкого переходу на i18next. Формат ключів: namespace.key (наприклад, nav.home)"})]}),e.jsxs(r,{onClick:()=>j(!0),children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Додати текст"]})]})}),e.jsxs(h,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(d,{placeholder:"Пошук по ключу, значенню, namespace або опису...",value:m,onChange:s=>A(s.target.value),className:"pl-9"})]}),m&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Знайдено текстів: ",c.length]})]}),m?e.jsx("div",{className:"space-y-4",children:c.length>0?c.map(s=>e.jsx(x,{children:e.jsx(h,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(t,{className:"text-xs text-muted-foreground",children:"Namespace"}),e.jsx("span",{className:"text-xs font-semibold px-2 py-1 bg-secondary rounded",children:s.namespace})]}),e.jsx(t,{className:"text-xs text-muted-foreground",children:"Ключ"}),e.jsx("p",{className:"font-mono text-sm font-semibold",children:s.key})]}),p!==s.id&&e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>S(s),className:"text-destructive hover:text-destructive",children:e.jsx(F,{className:"h-4 w-4"})})]}),p===s.id?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Текст"}),e.jsx(k,{value:f,onChange:a=>g(a.target.value),rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Опис (для справки)"}),e.jsx(d,{value:N,onChange:a=>y(a.target.value),placeholder:"Де використовується цей текст"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{onClick:()=>D(s),size:"sm",disabled:v.isPending,children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Зберегти"]}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>u(null),children:"Скасувати"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(t,{children:"Текст"}),e.jsx("p",{className:"text-sm mt-1 whitespace-pre-wrap",children:s.value})]}),s.description&&e.jsxs("div",{children:[e.jsx(t,{className:"text-xs text-muted-foreground",children:"Опис"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.description})]}),e.jsx(r,{size:"sm",variant:"outline",onClick:()=>b(s),children:"Редагувати"})]})]})})},s.id)):e.jsx(x,{children:e.jsx(h,{className:"py-12 text-center text-muted-foreground",children:"Текстів не знайдено"})})}):e.jsxs($,{defaultValue:C[0]||"",children:[e.jsx(G,{className:"flex flex-wrap gap-2 w-full mb-6",children:C.map(s=>e.jsx(J,{value:s,className:"flex-shrink-0",children:s},s))}),C.map(s=>e.jsxs(K,{value:s,className:"space-y-4 mt-4",children:[c.filter(a=>a.namespace===s).map(a=>e.jsx(x,{children:e.jsx(h,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(t,{className:"text-xs text-muted-foreground",children:"Ключ"}),e.jsx("p",{className:"font-mono text-sm font-semibold",children:a.key})]}),p!==a.id&&e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>S(a),className:"text-destructive hover:text-destructive",children:e.jsx(F,{className:"h-4 w-4"})})]}),p===a.id?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Текст"}),e.jsx(k,{value:f,onChange:w=>g(w.target.value),rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Опис (для справки)"}),e.jsx(d,{value:N,onChange:w=>y(w.target.value),placeholder:"Де використовується цей текст"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{onClick:()=>D(a),size:"sm",disabled:v.isPending,children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Зберегти"]}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>u(null),children:"Скасувати"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(t,{children:"Текст"}),e.jsx("p",{className:"text-sm mt-1 whitespace-pre-wrap",children:a.value})]}),a.description&&e.jsxs("div",{children:[e.jsx(t,{className:"text-xs text-muted-foreground",children:"Опис"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a.description})]}),e.jsx(r,{size:"sm",variant:"outline",onClick:()=>b(a),children:"Редагувати"})]})]})})},a.id)),c.filter(a=>a.namespace===s).length===0&&e.jsx(x,{children:e.jsx(h,{className:"py-12 text-center text-muted-foreground",children:"Немає текстів у цьому namespace"})})]},s))]})]})]}),e.jsx(M,{open:P,onOpenChange:j,children:e.jsxs(W,{children:[e.jsx(X,{children:e.jsx(Y,{children:"Додати новий текст"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"new-key",children:"Ключ * (формат: namespace.key)"}),e.jsx(d,{id:"new-key",value:i.key,onChange:s=>{const a=s.target.value;o({...i,key:a,namespace:a.includes(".")?a.split(".")[0]:i.namespace})},placeholder:"nav.home"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"new-namespace",children:"Namespace *"}),e.jsx(d,{id:"new-namespace",value:i.namespace,onChange:s=>o({...i,namespace:s.target.value}),placeholder:"nav"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"new-value",children:"Текст *"}),e.jsx(k,{id:"new-value",value:i.value,onChange:s=>o({...i,value:s.target.value}),rows:4,placeholder:"Текст для відображення"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"new-description",children:"Опис"}),e.jsx(d,{id:"new-description",value:i.description,onChange:s=>o({...i,description:s.target.value}),placeholder:"Де використовується цей текст"})]})]}),e.jsxs(Z,{children:[e.jsx(r,{variant:"outline",onClick:()=>j(!1),children:"Скасувати"}),e.jsx(r,{onClick:B,disabled:T.isPending,children:"Створити"})]})]})})]})}export{ge as Texts};
