import{r as f,j as e}from"./chunk-react-CHUe_c_M.js";import{B as L}from"./button-Dirq6-S7.js";import{I as F}from"./input-E_DkKYix.js";import{C as g,d as N,a as O,b as B}from"./card-DcmemaXX.js";import{B as D}from"./badge-CTncAuPo.js";import{S as v,a as y,b as S,c as w,d as p}from"./select-CsJALA_M.js";import{u as E,a as M}from"./useOrders-BQm_7tpr.js";import{d as Q}from"./index-Dv87KhRC.js";import{b as V}from"./chunk-router-BMV24Bow.js";import{bm as H,bn as T,b8 as _,aJ as q,aG as z,aF as A,aQ as G,aj as J}from"./chunk-vendor-C_GYGcpd.js";import"./chunk-lottie-DoMt_38f.js";import"./chunk-radix-BYx9rzOz.js";import"./chunk-query-BDB5idE8.js";const b={created:"Замовлення оформлено",accepted:"Прийнято",paid:"Оплачено",packed:"Спаковано",shipped:"Відправлено",arrived:"Прибуло",completed:"Залишити відгук",processing:"В обробці",assembled:"Зібрано",in_transit:"В дорозі"},C=["accepted","paid","packed","shipped","arrived","completed"],R={nova_poshta:"Нова Пошта",ukrposhta:"Укрпошта",pickup:"Самовивіз"},U=i=>{const l=typeof i=="string"?new Date(i):i,m=String(l.getHours()).padStart(2,"0"),d=String(l.getMinutes()).padStart(2,"0"),o=String(l.getDate()).padStart(2,"0"),c=String(l.getMonth()+1).padStart(2,"0"),x=l.getFullYear();return`${m}:${d}, ${o}.${c}.${x}`};function re(){const i=V(),{data:l=[],isLoading:m}=E(),{data:d=[]}=Q(),o=M(),[c,x]=f.useState(""),[h,k]=f.useState("all"),u=l.filter(s=>{const a=String(s.id).toLowerCase().includes(c.toLowerCase())||s.customer.name.toLowerCase().includes(c.toLowerCase())||s.customer.phone.includes(c),n=h==="all"||s.status===h;return a&&n}),$=(s,a)=>{o.mutate({id:s,status:a},{onSuccess:()=>{}})},P=s=>{var a;return((a=d.find(n=>n.code===s))==null?void 0:a.name)||s};return m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-muted-foreground",children:"Завантаження замовлень..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(g,{children:e.jsx(N,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(H,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(F,{placeholder:"Пошук за ID, ім'ям або телефоном...",value:c,onChange:s=>x(s.target.value),className:"pl-9"})]}),e.jsxs(v,{value:h,onValueChange:k,children:[e.jsxs(y,{className:"w-full sm:w-48",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),e.jsx(S,{placeholder:"Статус"})]}),e.jsxs(w,{children:[e.jsx(p,{value:"all",children:"Всі статуси"}),C.map(s=>e.jsx(p,{value:s,children:b[s]},s))]})]})]})})}),e.jsxs(g,{children:[e.jsx(O,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5"}),"Список замовлень"]})})}),e.jsx(N,{children:e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Заказ"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Сумма"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Покупатель"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Доставка и оплата"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Статус"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Действия"})]})}),e.jsx("tbody",{children:u.map(s=>{var j;const a=s.items[0],n=s.items.reduce((t,I)=>t+I.quantity,0),r=d.find(t=>t.code===(a==null?void 0:a.productId));return e.jsxs("tr",{className:"border-b hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>i(`/admin/orders/${s.id}`),children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:r!=null&&r.images&&r.images.length>0?e.jsx("img",{src:r.images[0],alt:r.name,className:"w-12 h-12 object-cover rounded"}):e.jsx("div",{className:"w-12 h-12 bg-muted rounded flex items-center justify-center",children:e.jsx(q,{className:"h-6 w-6 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-mono font-bold text-sm",children:s.id}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:U(s.createdAt)}),e.jsx("div",{className:"text-sm font-medium mt-1 truncate",children:a?P(a.productId):"Товар"}),s.items.length>1&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["+",s.items.length-1," товарів в замовленні"]})]})]})}),e.jsxs("td",{className:"py-4 px-4",children:[e.jsxs("div",{className:"font-bold",children:["₴",s.total]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[n," ","шт."]})]}),e.jsxs("td",{className:"py-4 px-4",children:[e.jsx("div",{className:"font-medium",children:s.customer.name}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-1 mt-1",children:[e.jsx(z,{className:"h-3 w-3"}),s.customer.phone]})]}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"space-y-2 text-sm text-foreground",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(A,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{children:R[s.delivery.method]}),s.delivery.city&&e.jsxs("div",{className:"text-xs mt-0.5",children:[s.delivery.city,s.delivery.warehouse&&`, ${s.delivery.warehouse}`,s.delivery.postIndex&&`, ${s.delivery.postIndex}`,s.delivery.address&&`, ${s.delivery.address}`]})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(G,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[s.payment.method==="wayforpay"&&"Онлайн оплата (WayForPay)",s.payment.method==="nalojka"&&"Оплата при отриманні",s.payment.method==="fopiban"&&"Оплата на рахунок ФОП"]})]})]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{value:s.status,onValueChange:t=>{$(s.id,t)},onClick:t=>t.stopPropagation(),children:[e.jsx(y,{className:"w-40",children:e.jsx(S,{})}),e.jsx(w,{children:C.map(t=>e.jsx(p,{value:t,children:b[t]},t))})]}),((j=s.payment)==null?void 0:j.status)==="paid"&&e.jsx(D,{className:"bg-green-100 text-green-800 text-xs",children:"Оплачено"})]})}),e.jsx("td",{className:"py-4 px-4 text-right",children:e.jsx(L,{variant:"outline",size:"icon",onClick:t=>{t.stopPropagation(),i(`/admin/orders/${s.id}`)},children:e.jsx(J,{className:"h-4 w-4"})})})]},s.id)})})]}),u.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Замовлення не знайдено"})]})})]})]})}export{re as Orders};
